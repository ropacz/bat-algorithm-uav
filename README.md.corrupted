# ğŸ¦‡ Bat Algorithm para UAVs - Desvio de ObstÃ¡culos# Bat Algorithm para UAV Swarm no OMNeT++



SimulaÃ§Ã£o de enxame de UAVs usando o Bat Algorithm (Algoritmo do Morcego) para navegaÃ§Ã£o com desvio de obstÃ¡culos estÃ¡ticos em OMNeT++ e INET Framework.SimulaÃ§Ã£o de enxame de drones (UAVs) usando o Bat Algorithm (algoritmo bio-inspirado) no OMNeT++ com INET Framework.



## ğŸ“‹ VisÃ£o Geral> **âš ï¸ IMPORTANTE**: Para compilar e executar o projeto corretamente, use o ambiente `opp_env`:

> ```bash

Este projeto implementa o **Bat Algorithm** (Yang, 2010) para controlar um enxame de UAVs (drones) que devem:> opp_env shell omnetpp-6.2.0 inet-4.5.4

- âœˆï¸ Navegar de uma posiÃ§Ã£o inicial atÃ© um alvo> ```

- ğŸ›‘ Desviar de obstÃ¡culos estÃ¡ticos durante o percurso> Isso configura todas as variÃ¡veis de ambiente necessÃ¡rias (OMNeT++, INET, paths, etc.)

- ğŸ”„ Convergir de forma cooperativa usando inteligÃªncia de enxame

## ğŸ“‹ DescriÃ§Ã£o

### CaracterÃ­sticas Principais

Este projeto implementa o **Bat Algorithm** (Yang, 2010) para controlar um enxame de UAVs que convergem para um ponto alvo. O algoritmo simula o comportamento de ecolocalizaÃ§Ã£o dos morcegos.

- **FÃ­sica Realista**: Movimento suave baseado em velocidade com integraÃ§Ã£o temporal

- **Desvio de ObstÃ¡culos**: DetecÃ§Ã£o e desvio com distÃ¢ncia de seguranÃ§a configurÃ¡vel### Componentes

- **Algoritmo Bat Puro**: ImplementaÃ§Ã£o fiel com frequÃªncia, loudness e pulse rate

- **MÃºltiplos CenÃ¡rios**: ConfiguraÃ§Ãµes de teste de simples a complexas- **ArbitraryMobility**: Mobilidade 3D realista para drones

- **BatAlgorithm**: ImplementaÃ§Ã£o do algoritmo Bat com:

## ğŸš€ InÃ­cio RÃ¡pido  - FrequÃªncia ajustÃ¡vel para exploraÃ§Ã£o

  - Loudness (volume) decrescente para convergÃªncia

### PrÃ©-requisitos  - Pulse rate crescente para refinamento

  - Busca local adaptativa

- **OMNeT++ 6.2.0** (instalado em `/Users/rodrigo/omnetpp-workspace/omnetpp-6.2.0`)- **UAV**: MÃ³dulo composto (mobilidade + algoritmo)

- **INET Framework 4.5.4** (instalado em `/Users/rodrigo/omnetpp-workspace/inet-4.5.4`)- **BatSwarmNetworkSimple**: Rede com mÃºltiplos UAVs

- **Python 3.10+** (para anÃ¡lise de resultados)

- **Bibliotecas Python**: `numpy`, `pandas`, `matplotlib`## ğŸš€ Quick Start



### InstalaÃ§Ã£o### 1. Compilar



```bash**MÃ©todo Recomendado (usando opp_env):**

# 1. Clone ou navegue atÃ© o diretÃ³rio do projeto```bash

cd /Users/rodrigo/omnetpp-workspace/bat-algorithmopp_env shell omnetpp-6.2.0 inet-4.5.4

cd ~/omnetpp-workspace/bat-algorithm

# 2. Compile o projetomake

./make.sh```



# 3. Execute uma simulaÃ§Ã£o (linha de comando)**MÃ©todo Alternativo (script):**

./run_sim.sh```bash

./make.sh

# 4. Ou abra a interface grÃ¡fica (requer Qt6)```

./run_qtenv_fixed.sh

```### 2. Executar SimulaÃ§Ã£o



### Executar SimulaÃ§Ã£o EspecÃ­fica```bash

# Terminal (recomendado)

```bash./run_sim.sh

# Simular com obstÃ¡culos simples (configuraÃ§Ã£o padrÃ£o)

cd simulations# Interface grÃ¡fica (Qtenv)

../src/bat-algorithm_dbg -u Cmdenv -c SimpleObstacles./run_qtenv_fixed.sh



# Simular com muitos obstÃ¡culos# OMNeT++ IDE - veja seÃ§Ã£o abaixo

../src/bat-algorithm_dbg -u Cmdenv -c ManyObstacles```



# Simular UAVs rÃ¡pidos com resposta reativa### 3. Analisar Resultados

../src/bat-algorithm_dbg -u Cmdenv -c FastAvoidance

``````bash

python analyze_results.py simulations/results

## ğŸ“Š AnÃ¡lise de Resultadosopen simulations/results/analysis/*.png

```

ApÃ³s executar uma simulaÃ§Ã£o, analise os resultados:

## ğŸ“ Estrutura do Projeto

```bash

# Instalar dependÃªncias Python (primeira vez)```

pip install numpy pandas matplotlibbat-algorithm/

â”œâ”€â”€ src/

# Executar anÃ¡liseâ”‚   â”œâ”€â”€ ArbitraryMobility.{h,cc,ned}  # Mobilidade 3D

python3 analyze_results.pyâ”‚   â”œâ”€â”€ BatAlgorithm.{h,cc,ned}       # Algoritmo Bat

```â”‚   â”œâ”€â”€ UAV.ned                        # MÃ³dulo UAV

â”‚   â””â”€â”€ package.ned

Isso irÃ¡ gerar:â”œâ”€â”€ simulations/

- ğŸ“ˆ **GrÃ¡ficos de convergÃªncia de fitness** por configuraÃ§Ã£oâ”‚   â”œâ”€â”€ BatSwarmNetworkSimple.ned     # Rede (sem visualizador)

- ğŸ›‘ **EstatÃ­sticas de obstÃ¡culos evitados** por UAVâ”‚   â”œâ”€â”€ omnetpp.ini                   # ConfiguraÃ§Ãµes

- ğŸ“‹ **Resumo de estatÃ­sticas** no terminalâ”‚   â””â”€â”€ results/                      # Resultados das simulaÃ§Ãµes

- ğŸ’¾ **Imagens PNG** salvas em `simulations/results/analysis/`â”œâ”€â”€ make.sh                           # Script de compilaÃ§Ã£o

â”œâ”€â”€ run_sim.sh                        # Executar (terminal)

## âš™ï¸ ConfiguraÃ§Ãµes DisponÃ­veisâ”œâ”€â”€ run_qtenv_fixed.sh                # Executar (GUI)

â”œâ”€â”€ analyze_results.py                # AnÃ¡lise de resultados

| ConfiguraÃ§Ã£o | UAVs | ObstÃ¡culos | DescriÃ§Ã£o |â”œâ”€â”€ README.md                         # DocumentaÃ§Ã£o principal

|-------------|------|------------|-----------|â”œâ”€â”€ BAT_ALGORITHM.md                  # Teoria do algoritmo

| `General` | 10 | 0 | BÃ¡sica sem obstÃ¡culos |â””â”€â”€ CONFIGURAR_IDE.md                 # InstruÃ§Ãµes do IDE

| `QuickTest` | 5 | 0 | Teste rÃ¡pido (60s) |```

| `SimpleObstacles` | 10 | 5 | ObstÃ¡culos simples â­ **Recomendado** |

| `ManyObstacles` | 15 | 10 | Campo denso de obstÃ¡culos |## âš™ï¸ ConfiguraÃ§Ãµes DisponÃ­veis

| `FastAvoidance` | 12 | 8 | UAVs rÃ¡pidos com resposta reativa |

| `ObstacleCourse` | 20 | 15 | Curso desafio com obstÃ¡culos grandes |Edite `simulations/omnetpp.ini` para ajustar:



## ğŸ—ï¸ Arquitetura do Projeto| ConfiguraÃ§Ã£o | UAVs | Tempo | DescriÃ§Ã£o |

|--------------|------|-------|-----------|

```| **QuickTest** | 5 | 60s | Teste rÃ¡pido |

bat-algorithm/| **SmallSwarm** | 10 | 300s | Enxame pequeno |

â”œâ”€â”€ src/                          # CÃ³digo-fonte C++| **MediumSwarm** | 20 | 300s | Enxame mÃ©dio |

â”‚   â”œâ”€â”€ BatAlgorithm.{h,cc,ned}  # ImplementaÃ§Ã£o do Bat Algorithm| **LargeSwarm** | 30 | 300s | Enxame grande |

â”‚   â”œâ”€â”€ ArbitraryMobility.{h,cc,ned}  # Modelo de mobilidade 3D| **FastConvergence** | 15 | 200s | ConvergÃªncia rÃ¡pida |

â”‚   â”œâ”€â”€ Obstacle.{h,cc,ned}      # MÃ³dulo de obstÃ¡culos| **SlowConvergence** | 15 | 400s | ExploraÃ§Ã£o lenta |

â”‚   â””â”€â”€ UAV.ned                   # DefiniÃ§Ã£o do drone (mÃ³dulo composto)

â”œâ”€â”€ simulations/                  # ConfiguraÃ§Ãµes de simulaÃ§Ã£o## ğŸ›ï¸ ParÃ¢metros do Bat Algorithm

â”‚   â”œâ”€â”€ BatSwarmNetworkSimple.ned        # Rede bÃ¡sica

â”‚   â”œâ”€â”€ BatSwarmNetworkWithObstacles.ned # Rede com obstÃ¡culos```ini

â”‚   â”œâ”€â”€ omnetpp.ini              # ParÃ¢metros de configuraÃ§Ã£o# FrequÃªncia (exploraÃ§Ã£o do espaÃ§o)

â”‚   â””â”€â”€ results/                  # Resultados das simulaÃ§Ãµes*.uav[*].batFrequencyMin = 0.0

â”œâ”€â”€ analyze_results.py            # Script de anÃ¡lise Python*.uav[*].batFrequencyMax = 2.0

â”œâ”€â”€ make.sh                       # Script de compilaÃ§Ã£o

â”œâ”€â”€ run_sim.sh                    # Executa simulaÃ§Ã£o CLI# Loudness (convergÃªncia)

â””â”€â”€ run_qtenv_fixed.sh            # Abre GUI do simulador*.uav[*].batLoudness = 0.9        # Inicial: alto = exploraÃ§Ã£o

```*.uav[*].batAlpha = 0.9           # ReduÃ§Ã£o: 0.85-0.95



## ğŸ§® Algoritmo Bat# Pulse Rate (refinamento)

*.uav[*].batPulseRate = 0.5       # Inicial

### Conceitos Principais*.uav[*].batGamma = 0.9           # Crescimento: 0.85-0.95



O Bat Algorithm simula o comportamento de ecolocaÃ§Ã£o dos morcegos:# AtualizaÃ§Ã£o

*.uav[*].batUpdateInterval = 1s

1. **FrequÃªncia (f)**: Controla o tamanho dos passos em direÃ§Ã£o ao alvo

   - Maior frequÃªncia = passos maiores (exploraÃ§Ã£o)# Alvo

   - Menor frequÃªncia = passos menores (explotaÃ§Ã£o)*.targetX = 1000m

*.targetY = 1000m

2. **Loudness (A)**: Intensidade do som (decresce ao se aproximar do alvo)*.targetZ = 150m

   - Alta loudness = mais exploraÃ§Ã£o```

   - Baixa loudness = mais explotaÃ§Ã£o

## ğŸ“Š MÃ©tricas Coletadas

3. **Pulse Rate (r)**: Taxa de emissÃ£o de pulsos (aumenta perto do alvo)

   - Baixa taxa = exploraÃ§Ã£o global- **Fitness**: DistÃ¢ncia de cada UAV ao alvo (menor = melhor)

   - Alta taxa = busca local intensiva- **Loudness**: Volume de ecolocalizaÃ§Ã£o

- **Pulse Rate**: Taxa de emissÃ£o de pulsos

### EquaÃ§Ãµes Implementadas

Resultados salvos em:

```cpp- `simulations/results/*.vec` - Dados vetoriais (sÃ©rie temporal)

// AtualizaÃ§Ã£o de velocidade- `simulations/results/*.sca` - Dados escalares (estatÃ­sticas)

velocity = velocity * inertia + (globalBest - currentPosition) * frequency

## ğŸ–¥ï¸ Usando o IDE do OMNeT++

// AtualizaÃ§Ã£o de posiÃ§Ã£o (integraÃ§Ã£o temporal)

newPosition = currentPosition + velocity * updateInterval### âš ï¸ IMPORTANTE: Build no IDE



// Fitness (minimizar distÃ¢ncia + penalidade de obstÃ¡culos)Se o build falhar no IDE com erro "inet/mobility/base/MovingMobilityBase.h not found":

fitness = distance_to_target + obstacle_penalty * obstacleWeight

```1. **Abra o IDE via opp_env**:

   ```bash

## ğŸ›‘ Sistema de Desvio de ObstÃ¡culos   opp_env shell omnetpp-6.2.0 inet-4.5.4

   omnetpp

### DetecÃ§Ã£o   ```



- **Alcance de DetecÃ§Ã£o**: UAV detecta obstÃ¡culos dentro de um raio configurÃ¡vel (default: 60m)2. **Configure as dependÃªncias**:

- **DistÃ¢ncia de SeguranÃ§a**: DistÃ¢ncia mÃ­nima segura dos obstÃ¡culos (default: 20m)   - Clique direito no projeto â†’ **Properties**

   - **Project References** â†’ âœ… Marque **inet-4.5.4**

### Penalidade   - **Apply and Close**



Quando um UAV se aproxima de um obstÃ¡culo:3. **Limpe e recompile**:

   - **Project â†’ Clean**

```cpp   - **Project â†’ Build Project**

// CÃ¡lculo exponencial de penalidade

distance_to_obstacle = obstacle.getDistanceToEdge(position)ğŸ“– **Para configuraÃ§Ã£o detalhada, veja**: `CONFIGURAR_IDE.md`

if (distance_to_obstacle < safetyDistance) {

    penalty += exp(-(distance_to_obstacle / safetyDistance)) * 100## ğŸ–¥ï¸ Usando o IDE do OMNeT++

}

```### Abrir o IDE



A penalidade cresce exponencialmente conforme o UAV se aproxima, forÃ§ando-o a desviar.```bash

opp_env shell omnetpp-6.2.0 inet-4.5.4

## ğŸ›ï¸ ParÃ¢metros Principaisomnetpp

```

### Bat Algorithm (`*.uav[*].batAlgorithm.*`)

### Configurar Projeto

| ParÃ¢metro | Valor PadrÃ£o | DescriÃ§Ã£o |

|-----------|--------------|-----------|1. **Importar**: **File â†’ Open Projects from File System** â†’ Selecione o projeto

| `frequencyMin` | 0.0 | FrequÃªncia mÃ­nima |2. **DependÃªncias**: Clique direito â†’ **Properties** â†’ **Project References** â†’ âœ… **inet-4.5.4**

| `frequencyMax` | 2.0 | FrequÃªncia mÃ¡xima |3. **Build**: **Project â†’ Clean** â†’ **Project â†’ Build Project**

| `loudness` | 0.9 | Loudness inicial |

| `pulseRate` | 0.5 | Taxa de pulso inicial |### Executar

| `alpha` | 0.9 | Fator de reduÃ§Ã£o de loudness |

| `gamma` | 0.9 | Fator de aumento de pulse rate |1. Clique direito em `simulations/omnetpp.ini`

| `updateInterval` | 1s | Intervalo de atualizaÃ§Ã£o do algoritmo |2. **Run As â†’ OMNeT++ Simulation** â†’ Escolha **QuickTest**



### ObstÃ¡culos (`*.uav[*].batAlgorithm.*`)ğŸ“– **Troubleshooting do IDE**: Veja `CONFIGURAR_IDE.md`



| ParÃ¢metro | Valor PadrÃ£o | DescriÃ§Ã£o |### Analisar no IDE

|-----------|--------------|-----------|

| `safetyDistance` | 20m | DistÃ¢ncia mÃ­nima segura |1. **Window â†’ Show View â†’ Analysis**

| `detectionRange` | 60m | Alcance de detecÃ§Ã£o |2. **Browse Data** â†’ selecione arquivos em `results/`

| `obstacleWeight` | 3.0 | Peso da penalidade de obstÃ¡culos |3. Clique direito â†’ **Plot**



### Mobilidade (`*.uav[*].mobility.*`)## ğŸ› Troubleshooting



| ParÃ¢metro | Valor PadrÃ£o | DescriÃ§Ã£o |### Build Error: "cannot be used outside an opp_env shell"

|-----------|--------------|-----------|

| `minSpeed` | 15 mps | Velocidade mÃ­nima (54 km/h) |**SoluÃ§Ã£o**: Use `./make.sh` ou compile dentro do `opp_env`:

| `maxSpeed` | 25 mps | Velocidade mÃ¡xima (90 km/h) |

| `updateInterval` | 0.1s | Intervalo de atualizaÃ§Ã£o de posiÃ§Ã£o |```bash

opp_env shell omnetpp-6.2.0 inet-4.5.4

## ğŸ“– DocumentaÃ§Ã£o Adicionalcd ~/omnetpp-workspace/bat-algorithm

make

- **[BAT_ALGORITHM.md](BAT_ALGORITHM.md)**: Detalhes tÃ©cnicos do algoritmo```

- **[CONFIGURAR_IDE.md](CONFIGURAR_IDE.md)**: Guia de configuraÃ§Ã£o do IDE

### Qtenv: Ãcones InvisÃ­veis (macOS)

## ğŸ› SoluÃ§Ã£o de Problemas

**Problema**: Qt6 no macOS tem problemas de renderizaÃ§Ã£o de Ã­cones

### Erro: "cannot find -lINET"

**SoluÃ§Ãµes**:

```bash1. Use atalhos: `F5` (Run), `F6` (Fast), `F8` (Stop)

# Certifique-se que o INET estÃ¡ compilado2. Mude tema: Dark â†” Light

cd /Users/rodrigo/omnetpp-workspace/inet-4.5.43. Use terminal: `./run_sim.sh`

make -j$(nproc)

### IDE: Erro "inet/mobility/.../h not found"

# Recompile o projeto

cd /Users/rodrigo/omnetpp-workspace/bat-algorithmVeja `CONFIGURAR_IDE.md` para instruÃ§Ãµes completas de configuraÃ§Ã£o do IDE.

./make.sh

``````bash

make cleanall

### Erro: "file not found: inet/..."make makefiles

./make.sh

```bash```

# Regenere o Makefile com caminhos corretos

cd src## ğŸ“š DocumentaÃ§Ã£o Adicional

opp_makemake -f --deep -O out -I. -I../simulations \

  -I/Users/rodrigo/omnetpp-workspace/inet-4.5.4/src \- **BAT_ALGORITHM.md**: Teoria do algoritmo, equaÃ§Ãµes, referÃªncias

  -L/Users/rodrigo/omnetpp-workspace/inet-4.5.4/src \- **analyze_results.py**: Script de anÃ¡lise (use `--help`)

  -lINET

```## ğŸ“ ReferÃªncias



### SimulaÃ§Ã£o nÃ£o inicia- Yang, X. S. (2010). "A new metaheuristic bat-inspired algorithm". Nature Inspired Cooperative Strategies for Optimization (NICSO 2010), 65-74.

- OMNeT++ Documentation: https://omnetpp.org

```bash- INET Framework: https://inet.omnetpp.org

# Verifique se o ambiente estÃ¡ configurado

source /Users/rodrigo/omnetpp-workspace/omnetpp-6.2.0/setenv## ğŸ“ Requisitos



# Execute com mais verbosidade- OMNeT++ 6.x

cd simulations- INET Framework 4.5.x

../src/bat-algorithm_dbg -u Cmdenv -c General -v- Python 3.x (para anÃ¡lise)

```  - numpy

  - matplotlib

## ğŸ“š ReferÃªncias  - pandas



- **Yang, X. S.** (2010). "A new metaheuristic bat-inspired algorithm". *Nature Inspired Cooperative Strategies for Optimization (NICSO 2010)*. Springer.## ğŸ”§ InstalaÃ§Ã£o das DependÃªncias Python

- **OMNeT++**: https://omnetpp.org/

- **INET Framework**: https://inet.omnetpp.org/```bash

pip install numpy matplotlib pandas

## ğŸ“„ LicenÃ§a```



Este projeto Ã© de cÃ³digo aberto e pode ser usado para fins educacionais e de pesquisa.## ğŸ“„ LicenÃ§a



## ğŸ‘¤ AutorLGPL v3



Desenvolvido como projeto de simulaÃ§Ã£o de enxame de UAVs usando OMNeT++ e INET Framework.## ğŸ‘¤ Autor



---Projeto de SimulaÃ§Ã£o de Drones com Bat Algorithm  

Outubro 2025

**Status do Projeto**: âœ… EstÃ¡vel e funcional

---

**Ãšltima AtualizaÃ§Ã£o**: Outubro 2025

## ğŸš€ Comandos RÃ¡pidos

```bash
# Entrar no ambiente (SEMPRE FAÃ‡A ISSO PRIMEIRO!)
opp_env shell omnetpp-6.2.0 inet-4.5.4

# Compilar
cd ~/omnetpp-workspace/bat-algorithm
make

# Executar (teste rÃ¡pido)
./run_sim.sh

# Analisar
python analyze_results.py simulations/results

# Visualizar
open simulations/results/analysis/*.png

# IDE
omnetpp
```

## âœ… Status

- âœ… CompilaÃ§Ã£o funcionando
- âœ… SimulaÃ§Ã£o executando
- âœ… Resultados sendo gerados
- âœ… AnÃ¡lise de dados funcionando
- âœ… Algoritmo Bat implementado
- âœ… Mobilidade 3D funcionando

**Projeto 100% funcional!** ğŸ‰
